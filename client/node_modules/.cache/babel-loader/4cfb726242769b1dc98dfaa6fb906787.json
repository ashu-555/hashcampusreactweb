{"ast":null,"code":"import _regeneratorRuntime from\"D:\\\\gitzip\\\\ReactwebHashcampus\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"D:\\\\gitzip\\\\ReactwebHashcampus\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:\\\\gitzip\\\\ReactwebHashcampus\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{useParams,useHistory}from'react-router-dom';import{useSelector}from'react-redux';import axios from'axios';import{showSuccessMsg,showErrMsg}from'../../utils/notification/Notification';function EditUser(){var _useParams=useParams(),id=_useParams.id;var history=useHistory();var _useState=useState([]),_useState2=_slicedToArray(_useState,2),editUser=_useState2[0],setEditUser=_useState2[1];var users=useSelector(function(state){return state.users;});var token=useSelector(function(state){return state.token;});var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),checkAdmin=_useState4[0],setCheckAdmin=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),err=_useState6[0],setErr=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),success=_useState8[0],setSuccess=_useState8[1];var _useState9=useState(0),_useState10=_slicedToArray(_useState9,2),num=_useState10[0],setNum=_useState10[1];useEffect(function(){if(users.length!==0){users.forEach(function(user){if(user._id===id){setEditUser(user);setCheckAdmin(user.role===1?true:false);}});}else{history.push('/profile');}},[users,id,history]);var handleUpdate=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;if(!(num%2!==0)){_context.next=7;break;}_context.next=4;return axios.patch(\"/user/update_role/\".concat(editUser._id),{role:checkAdmin?1:0},{headers:{Authorization:token}});case 4:res=_context.sent;setSuccess(res.data.msg);setNum(0);case 7:_context.next=12;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](0);_context.t0.response.data.msg&&setErr(_context.t0.response.data.msg);case 12:case\"end\":return _context.stop();}}},_callee,null,[[0,9]]);}));return function handleUpdate(){return _ref.apply(this,arguments);};}();var handleCheck=function handleCheck(){setSuccess('');setErr('');setCheckAdmin(!checkAdmin);setNum(num+1);};return/*#__PURE__*/React.createElement(\"div\",{className:\"profile_page edit_user\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"button\",{onClick:function onClick(){return history.goBack();},className:\"go_back\"},/*#__PURE__*/React.createElement(\"i\",{className:\"fas fa-long-arrow-alt-left\"}),\" Go Back\")),/*#__PURE__*/React.createElement(\"div\",{className:\"col-left\"},/*#__PURE__*/React.createElement(\"h2\",null,\"Edit User\"),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"name\"},\"Name\"),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",name:\"name\",defaultValue:editUser.name,disabled:true})),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"email\"},\"Email\"),/*#__PURE__*/React.createElement(\"input\",{type:\"email\",name:\"email\",defaultValue:editUser.email,disabled:true})),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"input\",{type:\"checkbox\",id:\"isAdmin\",checked:checkAdmin,onChange:handleCheck}),/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"isAdmin\"},\"isAdmin\")),/*#__PURE__*/React.createElement(\"button\",{onClick:handleUpdate},\"Update\"),err&&showErrMsg(err),success&&showSuccessMsg(success)));}export default EditUser;","map":{"version":3,"sources":["D:/gitzip/ReactwebHashcampus/client/src/components/body/profile/EditUser.js"],"names":["React","useState","useEffect","useParams","useHistory","useSelector","axios","showSuccessMsg","showErrMsg","EditUser","id","history","editUser","setEditUser","users","state","token","checkAdmin","setCheckAdmin","err","setErr","success","setSuccess","num","setNum","length","forEach","user","_id","role","push","handleUpdate","patch","headers","Authorization","res","data","msg","response","handleCheck","goBack","name","email"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from 'react'\nimport {useParams, useHistory} from 'react-router-dom'\nimport {useSelector} from 'react-redux'\nimport axios from 'axios'\nimport {showSuccessMsg, showErrMsg} from '../../utils/notification/Notification'\n\n\nfunction EditUser() {\n    const {id} = useParams()\n    const history = useHistory()\n    const [editUser, setEditUser] = useState([])\n\n    const users = useSelector(state => state.users)\n    const token = useSelector(state => state.token)\n\n    const [checkAdmin, setCheckAdmin] = useState(false)\n    const [err, setErr] = useState(false)\n    const [success, setSuccess] = useState(false)\n    const [num, setNum] = useState(0)\n\n    useEffect(() => {\n        if(users.length !== 0){\n            users.forEach(user => {\n                if(user._id === id){\n                    setEditUser(user)\n                    setCheckAdmin(user.role === 1 ? true : false)\n                }\n            })\n        }else{\n            history.push('/profile')\n        }\n    },[users, id, history])\n\n    const handleUpdate = async () => {\n        try {\n            if(num % 2 !== 0){\n                const res = await axios.patch(`/user/update_role/${editUser._id}`, {\n                    role: checkAdmin ? 1 : 0\n                }, {\n                    headers: {Authorization: token}\n                })\n\n                setSuccess(res.data.msg)\n                setNum(0)\n            }\n        } catch (err) {\n            err.response.data.msg && setErr(err.response.data.msg)\n        }\n    }\n\n    const handleCheck = () => {\n        setSuccess('')\n        setErr('')\n        setCheckAdmin(!checkAdmin)\n        setNum(num + 1)\n    }\n\n    return (\n        <div className=\"profile_page edit_user\">\n            <div className=\"row\">\n                <button onClick={() => history.goBack()} className=\"go_back\">\n                    <i className=\"fas fa-long-arrow-alt-left\"></i> Go Back\n                </button>\n            </div>\n\n            <div className=\"col-left\">\n                <h2>Edit User</h2>\n\n                <div className=\"form-group\">\n                    <label htmlFor=\"name\">Name</label>\n                    <input type=\"text\" name=\"name\" defaultValue={editUser.name} disabled/>\n                </div>\n\n                <div className=\"form-group\">\n                    <label htmlFor=\"email\">Email</label>\n                    <input type=\"email\" name=\"email\" defaultValue={editUser.email} disabled />\n                </div>\n\n                <div className=\"form-group\">\n                    <input type=\"checkbox\" id=\"isAdmin\" checked={checkAdmin}\n                    onChange={handleCheck} />\n                    <label htmlFor=\"isAdmin\">isAdmin</label>\n                </div>\n\n                <button onClick={handleUpdate}>Update</button>\n\n                {err && showErrMsg(err)}\n                {success && showSuccessMsg(success)}\n            </div>\n        </div>\n    )\n}\n\nexport default EditUser\n"]},"metadata":{},"sourceType":"module"}