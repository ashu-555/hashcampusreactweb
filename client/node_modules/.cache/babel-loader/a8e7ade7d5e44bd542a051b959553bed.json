{"ast":null,"code":"var _jsxFileName = \"D:\\\\gitzip\\\\ReactwebHashcampus\\\\client\\\\src\\\\components\\\\body\\\\profile\\\\Profile.js\";\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { useSelector, useDispatch } from 'react-redux'; // import {Link} from 'react-router-dom'\n\nimport { isLength, isMatch } from '../../utils/validation/Validation';\nimport { showSuccessMsg, showErrMsg } from '../../utils/notification/Notification';\nimport { fetchAllUsers, dispatchGetAllUsers } from '../../../redux/actions/usersAction';\nconst initialState = {\n  name: '',\n  password: '',\n  cf_password: '',\n  err: '',\n  success: ''\n};\n\nfunction Profile() {\n  const auth = useSelector(state => state.auth);\n  const token = useSelector(state => state.token); // const users = useSelector(state => state.users)\n\n  const {\n    user,\n    isAdmin\n  } = auth;\n  const [data, setData] = useState(initialState);\n  const {\n    name,\n    password,\n    cf_password,\n    err,\n    success\n  } = data;\n  const [avatar, setAvatar] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [callback, setCallback] = useState(false);\n  const dispatch = useDispatch();\n  useEffect(() => {\n    if (isAdmin) {\n      fetchAllUsers(token).then(res => {\n        dispatch(dispatchGetAllUsers(res));\n      });\n    }\n  }, [token, isAdmin, dispatch, callback]);\n\n  const handleChange = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    setData({ ...data,\n      [name]: value,\n      err: '',\n      success: ''\n    });\n  };\n\n  const changeAvatar = async e => {\n    e.preventDefault();\n\n    try {\n      const file = e.target.files[0];\n      if (!file) return setData({ ...data,\n        err: \"No files were uploaded.\",\n        success: ''\n      });\n      if (file.size > 1024 * 1024) return setData({ ...data,\n        err: \"Size too large.\",\n        success: ''\n      });\n      if (file.type !== 'image/jpeg' && file.type !== 'image/png') return setData({ ...data,\n        err: \"File format is incorrect.\",\n        success: ''\n      });\n      let formData = new FormData();\n      formData.append('file', file);\n      setLoading(true);\n      const res = await axios.post('/api/upload_avatar', formData, {\n        headers: {\n          'content-type': 'multipart/form-data',\n          Authorization: token\n        }\n      });\n      setLoading(false);\n      setAvatar(res.data.url);\n    } catch (err) {\n      setData({ ...data,\n        err: err.response.data.msg,\n        success: ''\n      });\n    }\n  };\n\n  const updateInfor = () => {\n    try {\n      axios.patch('/user/update', {\n        name: name ? name : user.name,\n        avatar: avatar ? avatar : user.avatar\n      }, {\n        headers: {\n          Authorization: token\n        }\n      });\n      setData({ ...data,\n        err: '',\n        success: \"Updated Success!\"\n      });\n    } catch (err) {\n      setData({ ...data,\n        err: err.response.data.msg,\n        success: ''\n      });\n    }\n  };\n\n  const updatePassword = () => {\n    if (isLength(password)) return setData({ ...data,\n      err: \"Password must be at least 6 characters.\",\n      success: ''\n    });\n    if (!isMatch(password, cf_password)) return setData({ ...data,\n      err: \"Password did not match.\",\n      success: ''\n    });\n\n    try {\n      axios.post('/user/reset', {\n        password\n      }, {\n        headers: {\n          Authorization: token\n        }\n      });\n      setData({ ...data,\n        err: '',\n        success: \"Updated Success!\"\n      });\n    } catch (err) {\n      setData({ ...data,\n        err: err.response.data.msg,\n        success: ''\n      });\n    }\n  };\n\n  const handleUpdate = () => {\n    if (name || avatar) updateInfor();\n    if (password) updatePassword();\n  }; // const handleDelete = async (id) => {\n  //     try {\n  //         if(user._id !== id){\n  //             if(window.confirm(\"Are you sure you want to delete this account?\")){\n  //                 setLoading(true)\n  //                 await axios.delete(`/user/delete/${id}`, {\n  //                     headers: {Authorization: token}\n  //                 })\n  //                 setLoading(false)\n  //                 setCallback(!callback)\n  //             }\n  //         }\n  //     } catch (err) {\n  //         setData({...data, err: err.response.data.msg , success: ''})\n  //     }\n  // }\n\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 9\n    }\n  }, err && showErrMsg(err), success && showSuccessMsg(success), loading && /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 25\n    }\n  }, \"Loading.....\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"profile_page\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-left\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 17\n    }\n  }, isAdmin ? \"Admin Profile\" : \"User Profile\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"avatar\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: avatar ? avatar : user.avatar,\n    alt: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: \"fas fa-camera\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 25\n    }\n  }), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 25\n    }\n  }, \"Change\"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"file\",\n    name: \"file\",\n    id: \"file_up\",\n    onChange: changeAvatar,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 25\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"name\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 21\n    }\n  }, \"Name\"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    name: \"name\",\n    id: \"name\",\n    defaultValue: user.name,\n    placeholder: \"Your name\",\n    onChange: handleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 21\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"email\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 21\n    }\n  }, \"Email\"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"email\",\n    name: \"email\",\n    id: \"email\",\n    defaultValue: user.email,\n    placeholder: \"Your email address\",\n    disabled: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 21\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"password\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 21\n    }\n  }, \"New Password\"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"password\",\n    name: \"password\",\n    id: \"password\",\n    placeholder: \"Your password\",\n    value: password,\n    onChange: handleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 21\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"cf_password\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 21\n    }\n  }, \"Confirm New Password\"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"password\",\n    name: \"cf_password\",\n    id: \"cf_password\",\n    placeholder: \"Confirm password\",\n    value: cf_password,\n    onChange: handleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 21\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"em\", {\n    style: {\n      color: \"crimson\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 21\n    }\n  }, \"* If you update your password here, you will not be able to login quickly using google and facebook.\")), /*#__PURE__*/React.createElement(\"button\", {\n    disabled: loading,\n    onClick: handleUpdate,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 17\n    }\n  }, \"Update\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 17\n    }\n  }, isAdmin ? \"Users\" : \"My Orders\"))));\n}\n\nexport default Profile;","map":{"version":3,"sources":["D:/gitzip/ReactwebHashcampus/client/src/components/body/profile/Profile.js"],"names":["React","useState","useEffect","axios","useSelector","useDispatch","isLength","isMatch","showSuccessMsg","showErrMsg","fetchAllUsers","dispatchGetAllUsers","initialState","name","password","cf_password","err","success","Profile","auth","state","token","user","isAdmin","data","setData","avatar","setAvatar","loading","setLoading","callback","setCallback","dispatch","then","res","handleChange","e","value","target","changeAvatar","preventDefault","file","files","size","type","formData","FormData","append","post","headers","Authorization","url","response","msg","updateInfor","patch","updatePassword","handleUpdate","email","color"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from 'react'\nimport axios from 'axios'\nimport {useSelector, useDispatch} from 'react-redux'\n// import {Link} from 'react-router-dom'\nimport {isLength, isMatch} from '../../utils/validation/Validation'\nimport {showSuccessMsg, showErrMsg} from '../../utils/notification/Notification'\nimport {fetchAllUsers, dispatchGetAllUsers} from '../../../redux/actions/usersAction'\n\nconst initialState = {\n    name: '',\n    password: '',\n    cf_password: '',\n    err: '',\n    success: ''\n}\n\nfunction Profile() {\n    const auth = useSelector(state => state.auth)\n    const token = useSelector(state => state.token)\n\n    // const users = useSelector(state => state.users)\n\n    const {user, isAdmin} = auth\n    const [data, setData] = useState(initialState)\n    const {name, password, cf_password, err, success} = data\n\n    const [avatar, setAvatar] = useState(false)\n    const [loading, setLoading] = useState(false)\n    const [callback, setCallback] = useState(false)\n\n    const dispatch = useDispatch()\n\n    useEffect(() => {\n        if(isAdmin){\n            fetchAllUsers(token).then(res =>{\n                dispatch(dispatchGetAllUsers(res))\n            })\n        }\n    },[token, isAdmin, dispatch, callback])\n\n    const handleChange = e => {\n        const {name, value} = e.target\n        setData({...data, [name]:value, err:'', success: ''})\n    }\n\n    const changeAvatar = async(e) => {\n        e.preventDefault()\n        try {\n            const file = e.target.files[0]\n\n            if(!file) return setData({...data, err: \"No files were uploaded.\" , success: ''})\n\n            if(file.size > 1024 * 1024)\n                return setData({...data, err: \"Size too large.\" , success: ''})\n\n            if(file.type !== 'image/jpeg' && file.type !== 'image/png')\n                return setData({...data, err: \"File format is incorrect.\" , success: ''})\n\n            let formData =  new FormData()\n            formData.append('file', file)\n\n            setLoading(true)\n            const res = await axios.post('/api/upload_avatar', formData, {\n                headers: {'content-type': 'multipart/form-data', Authorization: token}\n            })\n\n            setLoading(false)\n            setAvatar(res.data.url)\n            \n        } catch (err) {\n            setData({...data, err: err.response.data.msg , success: ''})\n        }\n    }\n\n    const updateInfor = () => {\n        try {\n            axios.patch('/user/update', {\n                name: name ? name : user.name,\n                avatar: avatar ? avatar : user.avatar\n            },{\n                headers: {Authorization: token}\n            })\n\n            setData({...data, err: '' , success: \"Updated Success!\"})\n        } catch (err) {\n            setData({...data, err: err.response.data.msg , success: ''})\n        }\n    }\n\n    const updatePassword = () => {\n        if(isLength(password))\n            return setData({...data, err: \"Password must be at least 6 characters.\", success: ''})\n\n        if(!isMatch(password, cf_password))\n            return setData({...data, err: \"Password did not match.\", success: ''})\n\n        try {\n            axios.post('/user/reset', {password},{\n                headers: {Authorization: token}\n            })\n\n            setData({...data, err: '' , success: \"Updated Success!\"})\n        } catch (err) {\n            setData({...data, err: err.response.data.msg , success: ''})\n        }\n    }\n\n    const handleUpdate = () => {\n        if(name || avatar) updateInfor()\n        if(password) updatePassword()\n    }\n\n    // const handleDelete = async (id) => {\n    //     try {\n    //         if(user._id !== id){\n    //             if(window.confirm(\"Are you sure you want to delete this account?\")){\n    //                 setLoading(true)\n    //                 await axios.delete(`/user/delete/${id}`, {\n    //                     headers: {Authorization: token}\n    //                 })\n    //                 setLoading(false)\n    //                 setCallback(!callback)\n    //             }\n    //         }\n            \n    //     } catch (err) {\n    //         setData({...data, err: err.response.data.msg , success: ''})\n    //     }\n    // }\n\n    return (\n        <>\n        <div>\n            {err && showErrMsg(err)}\n            {success && showSuccessMsg(success)}\n            {loading && <h3>Loading.....</h3>}\n        </div>\n        <div className=\"profile_page\">\n            <div className=\"col-left\">\n                <h2>{isAdmin ? \"Admin Profile\": \"User Profile\"}</h2>\n\n                <div className=\"avatar\">\n                    <img src={avatar ? avatar : user.avatar} alt=\"\"/>\n                    <span>\n                        <i className=\"fas fa-camera\"></i>\n                        <p>Change</p>\n                        <input type=\"file\" name=\"file\" id=\"file_up\" onChange={changeAvatar} />\n                    </span>\n                </div>\n\n                <div className=\"form-group\">\n                    <label htmlFor=\"name\">Name</label>\n                    <input type=\"text\" name=\"name\" id=\"name\" defaultValue={user.name}\n                    placeholder=\"Your name\" onChange={handleChange} />\n                </div>\n\n                <div className=\"form-group\">\n                    <label htmlFor=\"email\">Email</label>\n                    <input type=\"email\" name=\"email\" id=\"email\" defaultValue={user.email}\n                    placeholder=\"Your email address\" disabled />\n                </div>\n\n                <div className=\"form-group\">\n                    <label htmlFor=\"password\">New Password</label>\n                    <input type=\"password\" name=\"password\" id=\"password\"\n                    placeholder=\"Your password\" value={password} onChange={handleChange} />\n                </div>\n\n                <div className=\"form-group\">\n                    <label htmlFor=\"cf_password\">Confirm New Password</label>\n                    <input type=\"password\" name=\"cf_password\" id=\"cf_password\"\n                    placeholder=\"Confirm password\" value={cf_password} onChange={handleChange} />\n                </div>\n\n                <div>\n                    <em style={{color: \"crimson\"}}> \n                    * If you update your password here, you will not be able \n                        to login quickly using google and facebook.\n                    </em>\n                </div>\n\n                <button disabled={loading} onClick={handleUpdate}>Update</button>\n            </div>\n\n            <div className=\"col-right\">\n                <h2>{isAdmin ? \"Users\" : \"My Orders\"}</h2>\n\n                {/* <div style={{overflowX: \"auto\"}}>\n                    <table className=\"customers\">\n                        <thead>\n                            <tr>\n                                <th>ID</th>\n                                <th>Name</th>\n                                <th>Email</th>\n                                <th>Admin</th>\n                                <th>Action</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                            {\n                                users.map(user => (\n                                    <tr key={user._id}>\n                                        <td>{user._id}</td>\n                                        <td>{user.name}</td>\n                                        <td>{user.email}</td>\n                                        <td>\n                                            {\n                                                user.role === 1\n                                                ? <i className=\"fas fa-check\" title=\"Admin\"></i>\n                                                : <i className=\"fas fa-times\" title=\"User\"></i>\n                                            }\n                                        </td>\n                                        <td>\n                                            <Link to={`/edit_user/${user._id}`}>\n                                                <i className=\"fas fa-edit\" title=\"Edit\"></i>\n                                            </Link>\n                                            <i className=\"fas fa-trash-alt\" title=\"Remove\"\n                                            onClick={() => handleDelete(user._id)} ></i>\n                                        </td>\n                                    </tr>\n                                ))\n                            }\n                        </tbody>\n                    </table> */}\n                {/* </div> */}\n            </div>\n        </div>\n        </>\n    )\n}\n\nexport default Profile\n"]},"metadata":{},"sourceType":"module"}